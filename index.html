<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Variance : A variant type for Java, with customisable automatic type conversion" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Variance</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/youdevise/variance">View on GitHub</a>

          <h1 id="project_title">Variance</h1>
          <h2 id="project_tagline">A variant type for Java, with customisable automatic type conversion</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/youdevise/variance/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/youdevise/variance/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>VARIANCE</h1>

<p>The aim of <em>Variance</em> is to provide a general-purpose, custom-wirable junction box for conversion between Java types.</p>

<p>You put a value - any value - into a Variant, like so:</p>

<div class="highlight"><pre><span class="n">Variant</span> <span class="n">myVariant</span> <span class="o">=</span> <span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">myValue</span><span class="o">);</span>
</pre></div>

<p>You get it out again like so:</p>

<div class="highlight"><pre><span class="n">MyType</span> <span class="n">myInstance</span> <span class="o">=</span> <span class="n">myVariant</span><span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="n">MyType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>

<p>The value you put in doesn't have to belong to the type you pull out, but it must be <em>convertible</em> to that type.</p>

<p>By default, Variants can convert:</p>

<ul>
<li>Anything to String</li>
<li>Any type of Number to any other type of Number (and implement the Number interface themselves)</li>
<li>String to any kind of Number, and</li>
<li>Arrays/Iterables of things it knows how to convert into arrays/Iterables of converted things</li>
</ul><div class="highlight"><pre><span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"12"</span><span class="o">).</span><span class="na">doubleValue</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mf">12.0</span><span class="o">));</span>
<span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mf">12.0</span><span class="o">).</span><span class="na">toString</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="s">"12"</span><span class="o">));</span>
<span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">).</span><span class="na">asIterableOf</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">Contains</span><span class="o">.</span><span class="na">inOrder</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="s">"2"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">,</span> <span class="s">"4"</span><span class="o">));</span>
<span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"1,2,3,4"</span><span class="o">).</span><span class="na">asIterableOf</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">Contains</span><span class="o">.</span><span class="na">inOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">));</span>
</pre></div>

<p>You can wire in other conversions by adding them to the <em>context</em> the Variant uses to resolve requests for different types. A vanilla Variant will pull its context out of a ThreadLocal, such that you can write:</p>

<div class="highlight"><pre><span class="err">\\</span> <span class="n">Enter</span> <span class="n">a</span> <span class="n">context</span> <span class="n">in</span> <span class="n">which</span> <span class="n">numbers</span> <span class="n">are</span> <span class="n">formatted</span> <span class="n">to</span> <span class="mi">4</span><span class="n">d</span><span class="o">.</span><span class="na">p</span><span class="o">.</span> <span class="n">on</span> <span class="n">conversion</span> <span class="n">to</span> <span class="n">string</span>
<span class="n">ImplicitTypeConversions</span><span class="o">.</span><span class="na">enterExtended</span><span class="o">(</span><span class="n">myCustomContext</span><span class="o">);</span>

<span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">12</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">is</span><span class="o">(</span><span class="s">"12.0000"</span><span class="o">));</span>

<span class="err">\\</span> <span class="n">Leave</span> <span class="n">the</span> <span class="n">custom</span> <span class="n">context</span>
<span class="n">ImplicitTypeConversions</span><span class="o">.</span><span class="na">exit</span><span class="o">()</span>

<span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">12</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">is</span><span class="o">(</span><span class="s">"12"</span><span class="o">));</span>
</pre></div>

<p>Alternatively, you can bind a Variant explicitly to a context:</p>

<div class="highlight"><pre><span class="n">assertThat</span><span class="o">(</span><span class="n">Variant</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">12</span><span class="o">).</span><span class="na">in</span><span class="o">(</span><span class="n">myCustomContext</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">is</span><span class="o">(</span><span class="s">"12.0000"</span><span class="o">));</span>
</pre></div>

<p>In most cases, you will want to extend an existing context rather than create a new context from scratch:</p>

<div class="highlight"><pre><span class="n">TypeConversionContext</span> <span class="n">extended</span> <span class="o">=</span> <span class="n">ImplicitTypeConversions</span><span class="o">.</span><span class="na">getCurrent</span><span class="o">().</span><span class="na">extendedWith</span><span class="o">(</span><span class="n">extensions</span><span class="o">);</span>
</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Variance maintained by <a href="https://github.com/youdevise">youdevise</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
